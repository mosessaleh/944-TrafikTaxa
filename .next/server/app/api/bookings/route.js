"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/bookings/route";
exports.ids = ["app/api/bookings/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.ts&appDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.ts&appDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_moses_Projects_Websites_944_TrafikTaxa_app_api_bookings_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/bookings/route.ts */ \"(rsc)/./app/api/bookings/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/bookings/route\",\n        pathname: \"/api/bookings\",\n        filename: \"route\",\n        bundlePath: \"app/api/bookings/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\moses\\\\Projects\\\\Websites\\\\944-TrafikTaxa\\\\app\\\\api\\\\bookings\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_moses_Projects_Websites_944_TrafikTaxa_app_api_bookings_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/bookings/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZib29raW5ncyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYm9va2luZ3MlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZib29raW5ncyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNtb3NlcyU1Q1Byb2plY3RzJTVDV2Vic2l0ZXMlNUM5NDQtVHJhZmlrVGF4YSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDbW9zZXMlNUNQcm9qZWN0cyU1Q1dlYnNpdGVzJTVDOTQ0LVRyYWZpa1RheGEmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2tDO0FBQy9HO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vOTQ0LXRyYWZpay8/YzQ0OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxtb3Nlc1xcXFxQcm9qZWN0c1xcXFxXZWJzaXRlc1xcXFw5NDQtVHJhZmlrVGF4YVxcXFxhcHBcXFxcYXBpXFxcXGJvb2tpbmdzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9ib29raW5ncy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2Jvb2tpbmdzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9ib29raW5ncy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXG1vc2VzXFxcXFByb2plY3RzXFxcXFdlYnNpdGVzXFxcXDk0NC1UcmFmaWtUYXhhXFxcXGFwcFxcXFxhcGlcXFxcYm9va2luZ3NcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2Jvb2tpbmdzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.ts&appDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/bookings/route.ts":
/*!***********************************!*\
  !*** ./app/api/bookings/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_geocode_safe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/geocode-safe */ \"(rsc)/./lib/geocode-safe.ts\");\n/* harmony import */ var _lib_price__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/price */ \"(rsc)/./lib/price.ts\");\n/* harmony import */ var _lib_rate_limit__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/rate-limit */ \"(rsc)/./lib/rate-limit.ts\");\n\n\n\n\n\n\n\nconst Schema = zod__WEBPACK_IMPORTED_MODULE_6__.object({\n    riderName: zod__WEBPACK_IMPORTED_MODULE_6__.string().min(1),\n    pickupAddress: zod__WEBPACK_IMPORTED_MODULE_6__.string().min(1),\n    dropoffAddress: zod__WEBPACK_IMPORTED_MODULE_6__.string().min(1),\n    pickupLat: zod__WEBPACK_IMPORTED_MODULE_6__.number().optional().nullable(),\n    pickupLon: zod__WEBPACK_IMPORTED_MODULE_6__.number().optional().nullable(),\n    dropoffLat: zod__WEBPACK_IMPORTED_MODULE_6__.number().optional().nullable(),\n    dropoffLon: zod__WEBPACK_IMPORTED_MODULE_6__.number().optional().nullable(),\n    vehicleTypeId: zod__WEBPACK_IMPORTED_MODULE_6__.number().int(),\n    scheduled: zod__WEBPACK_IMPORTED_MODULE_6__.boolean(),\n    pickupTime: zod__WEBPACK_IMPORTED_MODULE_6__.string()\n});\nasync function GET() {\n    const u = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.getUserFromCookie)();\n    if (!u) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: false\n    }, {\n        status: 401\n    });\n    if (!u.emailVerified) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: false,\n        error: \"Email not verified\"\n    }, {\n        status: 403\n    });\n    const rides = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.ride.findMany({\n        where: {\n            userId: u.id\n        },\n        orderBy: {\n            createdAt: \"desc\"\n        }\n    });\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        rides\n    });\n}\nasync function POST(req) {\n    try {\n        await (0,_lib_rate_limit__WEBPACK_IMPORTED_MODULE_5__.limitOrThrow)(\"book:\" + (0,_lib_rate_limit__WEBPACK_IMPORTED_MODULE_5__.clientIpKey)(req), {\n            points: 5,\n            durationSec: 60\n        });\n    } catch (e) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Too many requests, try again later.\"\n        }, {\n            status: e?.status || 429\n        });\n    }\n    try {\n        const u = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.getUserFromCookie)();\n        if (!u) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Unauthorized\"\n        }, {\n            status: 401\n        });\n        if (!u.emailVerified) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Email not verified\"\n        }, {\n            status: 403\n        });\n        const data = Schema.parse(await req.json());\n        // Ensure vehicle type is active\n        const vt = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.vehicleType.findUnique({\n            where: {\n                id: data.vehicleTypeId\n            },\n            select: {\n                id: true,\n                active: true\n            }\n        });\n        if (!vt || !vt.active) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Vehicle type not available\"\n        }, {\n            status: 400\n        });\n        const { distanceKm, durationMin } = await (0,_lib_geocode_safe__WEBPACK_IMPORTED_MODULE_3__.safeEstimateDistance)({\n            address: data.pickupAddress,\n            lat: data.pickupLat || null,\n            lon: data.pickupLon || null\n        }, {\n            address: data.dropoffAddress,\n            lat: data.dropoffLat || null,\n            lon: data.dropoffLon || null\n        });\n        const at = new Date(data.pickupTime);\n        const price = await (0,_lib_price__WEBPACK_IMPORTED_MODULE_4__.computePrice)(distanceKm, durationMin, at, data.vehicleTypeId);\n        const ride = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.ride.create({\n            data: {\n                userId: u.id,\n                riderName: data.riderName,\n                passengers: 1,\n                pickupAddress: data.pickupAddress,\n                dropoffAddress: data.dropoffAddress,\n                scheduled: data.scheduled,\n                pickupTime: at,\n                distanceKm: Number(distanceKm.toFixed(2)),\n                durationMin,\n                price,\n                vehicleTypeId: data.vehicleTypeId\n            }\n        });\n        const admin = process.env.ADMIN_EMAIL || process.env.CONTACT_EMAIL;\n        if (admin) {\n            const title = data.scheduled ? \"Scheduled booking\" : \"Immediate booking\";\n            Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/nodemailer\"), __webpack_require__.e(\"_rsc_lib_email_ts\")]).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/email */ \"(rsc)/./lib/email.ts\")).then(({ sendEmail })=>sendEmail(admin, `${title} #${ride.id}`, `<p>New booking: Vehicle type ${data.vehicleTypeId}.<br/>Pickup: ${ride.pickupAddress}<br/>Dropoff: ${ride.dropoffAddress}<br/>Time: ${ride.pickupTime.toISOString()}<br/>Price: ${ride.price}</p>`)).catch(()=>{});\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true,\n            ride\n        });\n    } catch (e) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Could not place booking. Please refine addresses and try again.\"\n        }, {\n            status: 400\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsRUFBRSxDQUFDLDZCQUE2QixFQUFFUSxLQUFLekIsYUFBYSxDQUFDLGNBQWMsRUFBRWEsS0FBS3RCLGFBQWEsQ0FBQyxjQUFjLEVBQUVzQixLQUFLckIsY0FBYyxDQUFDLFdBQVcsRUFBRXFCLEtBQUtULFVBQVUsQ0FBQ2dELFdBQVcsR0FBRyxZQUFZLEVBQUV2QyxLQUFLMEIsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHYyxLQUFLLENBQUMsS0FBSztRQUN6UztRQUVBLE9BQU8zRSxxREFBWUEsQ0FBQzZCLElBQUksQ0FBQztZQUFFQyxJQUFHO1lBQU1LO1FBQUs7SUFDM0MsRUFBQyxPQUFNVyxHQUFNO1FBQ1gsT0FBTzlDLHFEQUFZQSxDQUFDNkIsSUFBSSxDQUFDO1lBQUVDLElBQUc7WUFBT0csT0FBTTtRQUFrRSxHQUFHO1lBQUVGLFFBQU87UUFBSTtJQUMvSDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vOTQ0LXRyYWZpay8uL2FwcC9hcGkvYm9va2luZ3Mvcm91dGUudHM/MTdhMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL2RiJztcbmltcG9ydCB7IGdldFVzZXJGcm9tQ29va2llIH0gZnJvbSAnQC9saWIvYXV0aCc7XG5pbXBvcnQgeyBzYWZlRXN0aW1hdGVEaXN0YW5jZSB9IGZyb20gJ0AvbGliL2dlb2NvZGUtc2FmZSc7XG5pbXBvcnQgeyBjb21wdXRlUHJpY2UgfSBmcm9tICdAL2xpYi9wcmljZSc7XG5pbXBvcnQgeyBjbGllbnRJcEtleSwgbGltaXRPclRocm93IH0gZnJvbSAnQC9saWIvcmF0ZS1saW1pdCc7XG5cbmNvbnN0IFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgcmlkZXJOYW1lOiB6LnN0cmluZygpLm1pbigxKSxcbiAgcGlja3VwQWRkcmVzczogei5zdHJpbmcoKS5taW4oMSksXG4gIGRyb3BvZmZBZGRyZXNzOiB6LnN0cmluZygpLm1pbigxKSxcbiAgcGlja3VwTGF0OiB6Lm51bWJlcigpLm9wdGlvbmFsKCkubnVsbGFibGUoKSxcbiAgcGlja3VwTG9uOiB6Lm51bWJlcigpLm9wdGlvbmFsKCkubnVsbGFibGUoKSxcbiAgZHJvcG9mZkxhdDogei5udW1iZXIoKS5vcHRpb25hbCgpLm51bGxhYmxlKCksXG4gIGRyb3BvZmZMb246IHoubnVtYmVyKCkub3B0aW9uYWwoKS5udWxsYWJsZSgpLFxuICB2ZWhpY2xlVHlwZUlkOiB6Lm51bWJlcigpLmludCgpLFxuICBzY2hlZHVsZWQ6IHouYm9vbGVhbigpLFxuICBwaWNrdXBUaW1lOiB6LnN0cmluZygpXG59KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpe1xuICBjb25zdCB1ID0gYXdhaXQgZ2V0VXNlckZyb21Db29raWUoKTtcbiAgaWYgKCF1KSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazpmYWxzZSB9LCB7IHN0YXR1czo0MDEgfSk7XG4gIGlmICghdS5lbWFpbFZlcmlmaWVkKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazpmYWxzZSwgZXJyb3I6J0VtYWlsIG5vdCB2ZXJpZmllZCcgfSwgeyBzdGF0dXM6NDAzIH0pO1xuICBjb25zdCByaWRlcyA9IGF3YWl0IHByaXNtYS5yaWRlLmZpbmRNYW55KHsgd2hlcmU6eyB1c2VySWQ6dS5pZCB9LCBvcmRlckJ5OnsgY3JlYXRlZEF0OidkZXNjJyB9IH0pO1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazp0cnVlLCByaWRlcyB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KXtcbiAgdHJ5eyBhd2FpdCBsaW1pdE9yVGhyb3coJ2Jvb2s6JytjbGllbnRJcEtleShyZXEpLCB7IHBvaW50czogNSwgZHVyYXRpb25TZWM6IDYwIH0pOyB9XG4gIGNhdGNoKGU6YW55KXsgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6ZmFsc2UsIGVycm9yOidUb28gbWFueSByZXF1ZXN0cywgdHJ5IGFnYWluIGxhdGVyLicgfSwgeyBzdGF0dXM6IGU/LnN0YXR1c3x8NDI5IH0pOyB9XG5cbiAgdHJ5e1xuICAgIGNvbnN0IHUgPSBhd2FpdCBnZXRVc2VyRnJvbUNvb2tpZSgpO1xuICAgIGlmICghdSkgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6ZmFsc2UsIGVycm9yOidVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOjQwMSB9KTtcbiAgICBpZiAoIXUuZW1haWxWZXJpZmllZCkgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6ZmFsc2UsIGVycm9yOidFbWFpbCBub3QgdmVyaWZpZWQnIH0sIHsgc3RhdHVzOjQwMyB9KTtcblxuICAgIGNvbnN0IGRhdGEgPSBTY2hlbWEucGFyc2UoYXdhaXQgcmVxLmpzb24oKSk7XG5cbiAgICAvLyBFbnN1cmUgdmVoaWNsZSB0eXBlIGlzIGFjdGl2ZVxuICAgIGNvbnN0IHZ0ID0gYXdhaXQgcHJpc21hLnZlaGljbGVUeXBlLmZpbmRVbmlxdWUoeyB3aGVyZTp7IGlkOiBkYXRhLnZlaGljbGVUeXBlSWQgfSwgc2VsZWN0OnsgaWQ6dHJ1ZSwgYWN0aXZlOnRydWUgfSB9KTtcbiAgICBpZiAoIXZ0IHx8ICF2dC5hY3RpdmUpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOmZhbHNlLCBlcnJvcjonVmVoaWNsZSB0eXBlIG5vdCBhdmFpbGFibGUnIH0sIHsgc3RhdHVzOjQwMCB9KTtcblxuICAgIGNvbnN0IHsgZGlzdGFuY2VLbSwgZHVyYXRpb25NaW4gfSA9IGF3YWl0IHNhZmVFc3RpbWF0ZURpc3RhbmNlKFxuICAgICAgeyBhZGRyZXNzOiBkYXRhLnBpY2t1cEFkZHJlc3MsIGxhdDogZGF0YS5waWNrdXBMYXR8fG51bGwsIGxvbjogZGF0YS5waWNrdXBMb258fG51bGwgfSxcbiAgICAgIHsgYWRkcmVzczogZGF0YS5kcm9wb2ZmQWRkcmVzcywgbGF0OiBkYXRhLmRyb3BvZmZMYXR8fG51bGwsIGxvbjogZGF0YS5kcm9wb2ZmTG9ufHxudWxsIH1cbiAgICApO1xuICAgIGNvbnN0IGF0ID0gbmV3IERhdGUoZGF0YS5waWNrdXBUaW1lKTtcbiAgICBjb25zdCBwcmljZSA9IGF3YWl0IGNvbXB1dGVQcmljZShkaXN0YW5jZUttLCBkdXJhdGlvbk1pbiwgYXQsIGRhdGEudmVoaWNsZVR5cGVJZCk7XG5cbiAgICBjb25zdCByaWRlID0gYXdhaXQgcHJpc21hLnJpZGUuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcklkOiB1LmlkLFxuICAgICAgICByaWRlck5hbWU6IGRhdGEucmlkZXJOYW1lLFxuICAgICAgICBwYXNzZW5nZXJzOiAxLFxuICAgICAgICBwaWNrdXBBZGRyZXNzOiBkYXRhLnBpY2t1cEFkZHJlc3MsXG4gICAgICAgIGRyb3BvZmZBZGRyZXNzOiBkYXRhLmRyb3BvZmZBZGRyZXNzLFxuICAgICAgICBzY2hlZHVsZWQ6IGRhdGEuc2NoZWR1bGVkLFxuICAgICAgICBwaWNrdXBUaW1lOiBhdCxcbiAgICAgICAgZGlzdGFuY2VLbTogTnVtYmVyKGRpc3RhbmNlS20udG9GaXhlZCgyKSksXG4gICAgICAgIGR1cmF0aW9uTWluLFxuICAgICAgICBwcmljZSxcbiAgICAgICAgdmVoaWNsZVR5cGVJZDogZGF0YS52ZWhpY2xlVHlwZUlkXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBhZG1pbiA9IHByb2Nlc3MuZW52LkFETUlOX0VNQUlMIHx8IHByb2Nlc3MuZW52LkNPTlRBQ1RfRU1BSUw7XG4gICAgaWYgKGFkbWluKSB7XG4gICAgICBjb25zdCB0aXRsZSA9IGRhdGEuc2NoZWR1bGVkID8gJ1NjaGVkdWxlZCBib29raW5nJyA6ICdJbW1lZGlhdGUgYm9va2luZyc7XG4gICAgICBpbXBvcnQoJ0AvbGliL2VtYWlsJykudGhlbigoeyBzZW5kRW1haWwgfSk9PiBzZW5kRW1haWwoYWRtaW4sIGAke3RpdGxlfSAjJHtyaWRlLmlkfWAsIGA8cD5OZXcgYm9va2luZzogVmVoaWNsZSB0eXBlICR7ZGF0YS52ZWhpY2xlVHlwZUlkfS48YnIvPlBpY2t1cDogJHtyaWRlLnBpY2t1cEFkZHJlc3N9PGJyLz5Ecm9wb2ZmOiAke3JpZGUuZHJvcG9mZkFkZHJlc3N9PGJyLz5UaW1lOiAke3JpZGUucGlja3VwVGltZS50b0lTT1N0cmluZygpfTxici8+UHJpY2U6ICR7cmlkZS5wcmljZX08L3A+YCkpLmNhdGNoKCgpPT57fSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6dHJ1ZSwgcmlkZSB9KTtcbiAgfWNhdGNoKGU6YW55KXtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazpmYWxzZSwgZXJyb3I6J0NvdWxkIG5vdCBwbGFjZSBib29raW5nLiBQbGVhc2UgcmVmaW5lIGFkZHJlc3NlcyBhbmQgdHJ5IGFnYWluLicgfSwgeyBzdGF0dXM6NDAwIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwieiIsInByaXNtYSIsImdldFVzZXJGcm9tQ29va2llIiwic2FmZUVzdGltYXRlRGlzdGFuY2UiLCJjb21wdXRlUHJpY2UiLCJjbGllbnRJcEtleSIsImxpbWl0T3JUaHJvdyIsIlNjaGVtYSIsIm9iamVjdCIsInJpZGVyTmFtZSIsInN0cmluZyIsIm1pbiIsInBpY2t1cEFkZHJlc3MiLCJkcm9wb2ZmQWRkcmVzcyIsInBpY2t1cExhdCIsIm51bWJlciIsIm9wdGlvbmFsIiwibnVsbGFibGUiLCJwaWNrdXBMb24iLCJkcm9wb2ZmTGF0IiwiZHJvcG9mZkxvbiIsInZlaGljbGVUeXBlSWQiLCJpbnQiLCJzY2hlZHVsZWQiLCJib29sZWFuIiwicGlja3VwVGltZSIsIkdFVCIsInUiLCJqc29uIiwib2siLCJzdGF0dXMiLCJlbWFpbFZlcmlmaWVkIiwiZXJyb3IiLCJyaWRlcyIsInJpZGUiLCJmaW5kTWFueSIsIndoZXJlIiwidXNlcklkIiwiaWQiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwiUE9TVCIsInJlcSIsInBvaW50cyIsImR1cmF0aW9uU2VjIiwiZSIsImRhdGEiLCJwYXJzZSIsInZ0IiwidmVoaWNsZVR5cGUiLCJmaW5kVW5pcXVlIiwic2VsZWN0IiwiYWN0aXZlIiwiZGlzdGFuY2VLbSIsImR1cmF0aW9uTWluIiwiYWRkcmVzcyIsImxhdCIsImxvbiIsImF0IiwiRGF0ZSIsInByaWNlIiwiY3JlYXRlIiwicGFzc2VuZ2VycyIsIk51bWJlciIsInRvRml4ZWQiLCJhZG1pbiIsInByb2Nlc3MiLCJlbnYiLCJBRE1JTl9FTUFJTCIsIkNPTlRBQ1RfRU1BSUwiLCJ0aXRsZSIsInRoZW4iLCJzZW5kRW1haWwiLCJ0b0lTT1N0cmluZyIsImNhdGNoIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/bookings/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSessionCookie: () => (/* binding */ clearSessionCookie),\n/* harmony export */   comparePassword: () => (/* binding */ comparePassword),\n/* harmony export */   getUserFromCookie: () => (/* binding */ getUserFromCookie),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   signToken: () => (/* binding */ signToken)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/crypto */ \"(rsc)/./lib/crypto.ts\");\n\n\n\n\nconst SECRET = process.env.SECRET || \"change_me_dev_secret\";\nfunction signToken(payload) {\n    return (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)(payload, SECRET, {\n        expiresIn: \"7d\"\n    });\n}\nasync function hashPassword(password) {\n    return (0,_lib_crypto__WEBPACK_IMPORTED_MODULE_3__.hashPassword)(password);\n}\nasync function comparePassword(plain, hashed) {\n    return (0,_lib_crypto__WEBPACK_IMPORTED_MODULE_3__.comparePassword)(plain, hashed);\n}\nfunction setSessionCookie(token) {\n    const jar = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const secure = String(process.env.COOKIE_SECURE || \"false\").toLowerCase() === \"true\";\n    jar.set(\"session\", token, {\n        httpOnly: true,\n        sameSite: \"lax\",\n        secure,\n        path: \"/\",\n        maxAge: 60 * 60 * 24 * 7\n    });\n}\nfunction clearSessionCookie() {\n    const jar = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const secure = String(process.env.COOKIE_SECURE || \"false\").toLowerCase() === \"true\";\n    jar.set(\"session\", \"\", {\n        httpOnly: true,\n        sameSite: \"lax\",\n        secure,\n        path: \"/\",\n        maxAge: 0\n    });\n}\nasync function getUserFromCookie() {\n    const token = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)().get(\"session\")?.value;\n    if (!token) return null;\n    try {\n        const dec = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, SECRET);\n        const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findUnique({\n            where: {\n                id: dec.id\n            }\n        });\n        return user;\n    } catch  {\n        return null;\n    }\n}\nasync function requireAdmin() {\n    const u = await getUserFromCookie();\n    if (!u || u.role !== \"ADMIN\") throw Object.assign(new Error(\"Forbidden\"), {\n        status: 403\n    });\n    return u;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBdUM7QUFDTDtBQUNVO0FBQytCO0FBRTNFLE1BQU1RLFNBQVNDLFFBQVFDLEdBQUcsQ0FBQ0YsTUFBTSxJQUFJO0FBRTlCLFNBQVNHLFVBQVVDLE9BQTRCO0lBQ3BELE9BQU9WLGtEQUFJQSxDQUFDVSxTQUFTSixRQUFRO1FBQUVLLFdBQVc7SUFBSztBQUNqRDtBQUVPLGVBQWVQLGFBQWFRLFFBQWdCO0lBQUcsT0FBT1AseURBQUdBLENBQUNPO0FBQVc7QUFDckUsZUFBZVYsZ0JBQWdCVyxLQUFhLEVBQUVDLE1BQWM7SUFBRyxPQUFPWCw0REFBR0EsQ0FBQ1UsT0FBT0M7QUFBUztBQUUxRixTQUFTQyxpQkFBaUJDLEtBQWE7SUFDNUMsTUFBTUMsTUFBTW5CLHFEQUFPQTtJQUNuQixNQUFNb0IsU0FBU0MsT0FBT1osUUFBUUMsR0FBRyxDQUFDWSxhQUFhLElBQUUsU0FBU0MsV0FBVyxPQUFPO0lBQzVFSixJQUFJSyxHQUFHLENBQUMsV0FBV04sT0FBTztRQUFFTyxVQUFVO1FBQU1DLFVBQVU7UUFBT047UUFBUU8sTUFBTTtRQUFLQyxRQUFRLEtBQUcsS0FBRyxLQUFHO0lBQUU7QUFDckc7QUFFTyxTQUFTQztJQUNkLE1BQU1WLE1BQU1uQixxREFBT0E7SUFDbkIsTUFBTW9CLFNBQVNDLE9BQU9aLFFBQVFDLEdBQUcsQ0FBQ1ksYUFBYSxJQUFFLFNBQVNDLFdBQVcsT0FBTztJQUM1RUosSUFBSUssR0FBRyxDQUFDLFdBQVcsSUFBSTtRQUFFQyxVQUFTO1FBQU1DLFVBQVM7UUFBT047UUFBUU8sTUFBSztRQUFLQyxRQUFRO0lBQUU7QUFDdEY7QUFFTyxlQUFlRTtJQUNwQixNQUFNWixRQUFRbEIscURBQU9BLEdBQUcrQixHQUFHLENBQUMsWUFBWUM7SUFDeEMsSUFBSSxDQUFDZCxPQUFPLE9BQU87SUFDbkIsSUFBRztRQUNELE1BQU1lLE1BQVc5QixvREFBTUEsQ0FBQ2UsT0FBT1Y7UUFDL0IsTUFBTTBCLE9BQU8sTUFBTWpDLDJDQUFNQSxDQUFDaUMsSUFBSSxDQUFDQyxVQUFVLENBQUM7WUFBRUMsT0FBTztnQkFBRUMsSUFBSUosSUFBSUksRUFBRTtZQUFDO1FBQUU7UUFDbEUsT0FBT0g7SUFDVCxFQUFDLE9BQUs7UUFBRSxPQUFPO0lBQU07QUFDdkI7QUFFTyxlQUFlSTtJQUNwQixNQUFNQyxJQUFJLE1BQU1UO0lBQ2hCLElBQUksQ0FBQ1MsS0FBS0EsRUFBRUMsSUFBSSxLQUFLLFNBQVMsTUFBTUMsT0FBT0MsTUFBTSxDQUFDLElBQUlDLE1BQU0sY0FBYztRQUFFQyxRQUFRO0lBQUk7SUFDeEYsT0FBT0w7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovLzk0NC10cmFmaWsvLi9saWIvYXV0aC50cz9iZjdlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvZGInO1xuaW1wb3J0IHsgc2lnbiwgdmVyaWZ5IH0gZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCB7IGNvbXBhcmVQYXNzd29yZCBhcyBjbXAsIGhhc2hQYXNzd29yZCBhcyBoc2ggfSBmcm9tICdAL2xpYi9jcnlwdG8nO1xuXG5jb25zdCBTRUNSRVQgPSBwcm9jZXNzLmVudi5TRUNSRVQgfHwgJ2NoYW5nZV9tZV9kZXZfc2VjcmV0JztcblxuZXhwb3J0IGZ1bmN0aW9uIHNpZ25Ub2tlbihwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KXtcbiAgcmV0dXJuIHNpZ24ocGF5bG9hZCwgU0VDUkVULCB7IGV4cGlyZXNJbjogJzdkJyB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc2hQYXNzd29yZChwYXNzd29yZDogc3RyaW5nKXsgcmV0dXJuIGhzaChwYXNzd29yZCk7IH1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb21wYXJlUGFzc3dvcmQocGxhaW46IHN0cmluZywgaGFzaGVkOiBzdHJpbmcpeyByZXR1cm4gY21wKHBsYWluLCBoYXNoZWQpOyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKHRva2VuOiBzdHJpbmcpe1xuICBjb25zdCBqYXIgPSBjb29raWVzKCk7XG4gIGNvbnN0IHNlY3VyZSA9IFN0cmluZyhwcm9jZXNzLmVudi5DT09LSUVfU0VDVVJFfHwnZmFsc2UnKS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7XG4gIGphci5zZXQoJ3Nlc3Npb24nLCB0b2tlbiwgeyBodHRwT25seTogdHJ1ZSwgc2FtZVNpdGU6ICdsYXgnLCBzZWN1cmUsIHBhdGg6ICcvJywgbWF4QWdlOiA2MCo2MCoyNCo3IH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJTZXNzaW9uQ29va2llKCl7XG4gIGNvbnN0IGphciA9IGNvb2tpZXMoKTtcbiAgY29uc3Qgc2VjdXJlID0gU3RyaW5nKHByb2Nlc3MuZW52LkNPT0tJRV9TRUNVUkV8fCdmYWxzZScpLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJztcbiAgamFyLnNldCgnc2Vzc2lvbicsICcnLCB7IGh0dHBPbmx5OnRydWUsIHNhbWVTaXRlOidsYXgnLCBzZWN1cmUsIHBhdGg6Jy8nLCBtYXhBZ2U6IDAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyRnJvbUNvb2tpZSgpe1xuICBjb25zdCB0b2tlbiA9IGNvb2tpZXMoKS5nZXQoJ3Nlc3Npb24nKT8udmFsdWU7XG4gIGlmICghdG9rZW4pIHJldHVybiBudWxsO1xuICB0cnl7XG4gICAgY29uc3QgZGVjOiBhbnkgPSB2ZXJpZnkodG9rZW4sIFNFQ1JFVCk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogZGVjLmlkIH0gfSk7XG4gICAgcmV0dXJuIHVzZXI7XG4gIH1jYXRjaHsgcmV0dXJuIG51bGw7IH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBZG1pbigpe1xuICBjb25zdCB1ID0gYXdhaXQgZ2V0VXNlckZyb21Db29raWUoKTtcbiAgaWYgKCF1IHx8IHUucm9sZSAhPT0gJ0FETUlOJykgdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IoJ0ZvcmJpZGRlbicpLCB7IHN0YXR1czogNDAzIH0pO1xuICByZXR1cm4gdTtcbn1cbiJdLCJuYW1lcyI6WyJjb29raWVzIiwicHJpc21hIiwic2lnbiIsInZlcmlmeSIsImNvbXBhcmVQYXNzd29yZCIsImNtcCIsImhhc2hQYXNzd29yZCIsImhzaCIsIlNFQ1JFVCIsInByb2Nlc3MiLCJlbnYiLCJzaWduVG9rZW4iLCJwYXlsb2FkIiwiZXhwaXJlc0luIiwicGFzc3dvcmQiLCJwbGFpbiIsImhhc2hlZCIsInNldFNlc3Npb25Db29raWUiLCJ0b2tlbiIsImphciIsInNlY3VyZSIsIlN0cmluZyIsIkNPT0tJRV9TRUNVUkUiLCJ0b0xvd2VyQ2FzZSIsInNldCIsImh0dHBPbmx5Iiwic2FtZVNpdGUiLCJwYXRoIiwibWF4QWdlIiwiY2xlYXJTZXNzaW9uQ29va2llIiwiZ2V0VXNlckZyb21Db29raWUiLCJnZXQiLCJ2YWx1ZSIsImRlYyIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpZCIsInJlcXVpcmVBZG1pbiIsInUiLCJyb2xlIiwiT2JqZWN0IiwiYXNzaWduIiwiRXJyb3IiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/crypto.ts":
/*!***********************!*\
  !*** ./lib/crypto.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   comparePassword: () => (/* binding */ comparePassword),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n\nasync function hashPassword(password) {\n    const saltRounds = 10;\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__.hash(password, saltRounds);\n}\nasync function comparePassword(plain, hashed) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__.compare(plain, hashed);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY3J5cHRvLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFtQztBQUU1QixlQUFlQyxhQUFhQyxRQUFnQjtJQUNqRCxNQUFNQyxhQUFhO0lBQ25CLE9BQU9ILDBDQUFXLENBQUNFLFVBQVVDO0FBQy9CO0FBRU8sZUFBZUUsZ0JBQWdCQyxLQUFhLEVBQUVDLE1BQWM7SUFDakUsT0FBT1AsNkNBQWMsQ0FBQ00sT0FBT0M7QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly85NDQtdHJhZmlrLy4vbGliL2NyeXB0by50cz85MjVhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyl7XG4gIGNvbnN0IHNhbHRSb3VuZHMgPSAxMDtcbiAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0Um91bmRzKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbXBhcmVQYXNzd29yZChwbGFpbjogc3RyaW5nLCBoYXNoZWQ6IHN0cmluZyl7XG4gIHJldHVybiBiY3J5cHQuY29tcGFyZShwbGFpbiwgaGFzaGVkKTtcbn1cbiJdLCJuYW1lcyI6WyJiY3J5cHQiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsInNhbHRSb3VuZHMiLCJoYXNoIiwiY29tcGFyZVBhc3N3b3JkIiwicGxhaW4iLCJoYXNoZWQiLCJjb21wYXJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/crypto.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\n// Prevent multiple Prisma instances in dev (Next.js HMR)\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThDO0FBRTlDLHlEQUF5RDtBQUN6RCxNQUFNQyxrQkFBa0JDO0FBRWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxDQUFDO0lBQy9ESSxLQUFLQyxLQUF5QixHQUFnQjtRQUFDO1FBQVE7UUFBUTtLQUFPLEdBQUcsQ0FBUztBQUNwRixHQUFHO0FBRUgsSUFBSUEsSUFBeUIsRUFBY0osZ0JBQWdCRSxNQUFNLEdBQUdBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vOTQ0LXRyYWZpay8uL2xpYi9kYi50cz8xZGYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcblxuLy8gUHJldmVudCBtdWx0aXBsZSBQcmlzbWEgaW5zdGFuY2VzIGluIGRldiAoTmV4dC5qcyBITVIpXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMgeyBwcmlzbWE/OiBQcmlzbWFDbGllbnQgfTtcblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgfHwgbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ3F1ZXJ5JywnZXJyb3InLCd3YXJuJ10gOiBbJ2Vycm9yJ11cbn0pO1xuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/geocode-safe.ts":
/*!*****************************!*\
  !*** ./lib/geocode-safe.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   safeEstimateDistance: () => (/* binding */ safeEstimateDistance)\n/* harmony export */ });\nfunction badText(a) {\n    const s = (a || \"\").trim();\n    if (!s) return true;\n    if (s.length > 200) return true;\n    if (/^https?:\\/\\//i.test(s)) return true;\n    if (/[<>]/.test(s)) return true;\n    return false;\n}\nasync function osrmDistance(lat1, lon1, lat2, lon2) {\n    const url = `https://router.project-osrm.org/route/v1/driving/${lon1},${lat1};${lon2},${lat2}?overview=false`;\n    const r = await fetch(url, {\n        headers: {\n            \"Accept\": \"application/json\"\n        },\n        next: {\n            revalidate: 0\n        }\n    });\n    if (!r.ok) throw new Error(\"OSRM failed\");\n    const j = await r.json();\n    const route = j?.routes?.[0];\n    if (!route) throw new Error(\"No route\");\n    const distanceKm = route.distance / 1000;\n    const durationMin = Math.max(1, Math.round(route.duration / 60));\n    return {\n        distanceKm,\n        durationMin\n    };\n}\nasync function geocode(addr) {\n    const u = new URL(\"https://nominatim.openstreetmap.org/search\");\n    u.searchParams.set(\"format\", \"json\");\n    u.searchParams.set(\"q\", addr);\n    u.searchParams.set(\"limit\", \"1\");\n    const r = await fetch(u, {\n        headers: {\n            \"Accept\": \"application/json\",\n            \"User-Agent\": \"944-trafik-app\"\n        },\n        next: {\n            revalidate: 0\n        }\n    });\n    if (!r.ok) throw new Error(\"Geocode failed\");\n    const j = await r.json();\n    const p = j?.[0];\n    if (!p) throw new Error(\"No geocode\");\n    return {\n        lat: Number(p.lat),\n        lon: Number(p.lon)\n    };\n}\nasync function safeEstimateDistance(a, b) {\n    // 1) Prefer coordinates when available\n    if (Number.isFinite(a.lat) && Number.isFinite(a.lon) && Number.isFinite(b.lat) && Number.isFinite(b.lon)) {\n        return osrmDistance(a.lat, a.lon, b.lat, b.lon);\n    }\n    // 2) Fallback to text addresses (sanitize)\n    const at = (a.address || \"\").trim();\n    const bt = (b.address || \"\").trim();\n    if (badText(at) || badText(bt)) throw new Error(\"Invalid address input\");\n    const A = await geocode(at);\n    const B = await geocode(bt);\n    return osrmDistance(A.lat, A.lon, B.lat, B.lon);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUssTUFBTSxJQUFJM0IsTUFBTTtJQUNoRCxNQUFNNEIsSUFBSSxNQUFNaEIsUUFBUWE7SUFDeEIsTUFBTUksSUFBSSxNQUFNakIsUUFBUWU7SUFDeEIsT0FBT3ZDLGFBQWF3QyxFQUFFVCxHQUFHLEVBQUVTLEVBQUVQLEdBQUcsRUFBRVEsRUFBRVYsR0FBRyxFQUFFVSxFQUFFUixHQUFHO0FBQ2hEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vOTQ0LXRyYWZpay8uL2xpYi9nZW9jb2RlLXNhZmUudHM/MzgyYiJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBiYWRUZXh0KGE6IHN0cmluZyl7XG4gIGNvbnN0IHMgPSAoYXx8JycpLnRyaW0oKTtcbiAgaWYgKCFzKSByZXR1cm4gdHJ1ZTtcbiAgaWYgKHMubGVuZ3RoID4gMjAwKSByZXR1cm4gdHJ1ZTtcbiAgaWYgKC9eaHR0cHM/OlxcL1xcLy9pLnRlc3QocykpIHJldHVybiB0cnVlO1xuICBpZiAoL1s8Pl0vLnRlc3QocykpIHJldHVybiB0cnVlO1xuICByZXR1cm4gZmFsc2U7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG9zcm1EaXN0YW5jZShsYXQxOm51bWJlciwgbG9uMTpudW1iZXIsIGxhdDI6bnVtYmVyLCBsb24yOm51bWJlcil7XG4gIGNvbnN0IHVybCA9IGBodHRwczovL3JvdXRlci5wcm9qZWN0LW9zcm0ub3JnL3JvdXRlL3YxL2RyaXZpbmcvJHtsb24xfSwke2xhdDF9OyR7bG9uMn0sJHtsYXQyfT9vdmVydmlldz1mYWxzZWA7XG4gIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwsIHsgaGVhZGVyczp7J0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24nfSwgbmV4dDp7IHJldmFsaWRhdGU6MCB9IH0pO1xuICBpZighci5vaykgdGhyb3cgbmV3IEVycm9yKCdPU1JNIGZhaWxlZCcpO1xuICBjb25zdCBqID0gYXdhaXQgci5qc29uKCk7XG4gIGNvbnN0IHJvdXRlID0gaj8ucm91dGVzPy5bMF07XG4gIGlmKCFyb3V0ZSkgdGhyb3cgbmV3IEVycm9yKCdObyByb3V0ZScpO1xuICBjb25zdCBkaXN0YW5jZUttID0gcm91dGUuZGlzdGFuY2UgLyAxMDAwO1xuICBjb25zdCBkdXJhdGlvbk1pbiA9IE1hdGgubWF4KDEsIE1hdGgucm91bmQocm91dGUuZHVyYXRpb24gLyA2MCkpO1xuICByZXR1cm4geyBkaXN0YW5jZUttLCBkdXJhdGlvbk1pbiB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZW9jb2RlKGFkZHI6c3RyaW5nKXtcbiAgY29uc3QgdSA9IG5ldyBVUkwoJ2h0dHBzOi8vbm9taW5hdGltLm9wZW5zdHJlZXRtYXAub3JnL3NlYXJjaCcpO1xuICB1LnNlYXJjaFBhcmFtcy5zZXQoJ2Zvcm1hdCcsJ2pzb24nKTtcbiAgdS5zZWFyY2hQYXJhbXMuc2V0KCdxJywgYWRkcik7XG4gIHUuc2VhcmNoUGFyYW1zLnNldCgnbGltaXQnLCcxJyk7XG4gIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1LCB7IGhlYWRlcnM6eydBY2NlcHQnOidhcHBsaWNhdGlvbi9qc29uJywnVXNlci1BZ2VudCc6Jzk0NC10cmFmaWstYXBwJ30sIG5leHQ6eyByZXZhbGlkYXRlOiAwIH0gfSk7XG4gIGlmKCFyLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ0dlb2NvZGUgZmFpbGVkJyk7XG4gIGNvbnN0IGo6YW55W10gPSBhd2FpdCByLmpzb24oKTtcbiAgY29uc3QgcCA9IGo/LlswXTsgaWYoIXApIHRocm93IG5ldyBFcnJvcignTm8gZ2VvY29kZScpO1xuICByZXR1cm4geyBsYXQ6IE51bWJlcihwLmxhdCksIGxvbjogTnVtYmVyKHAubG9uKSB9O1xufVxuXG5leHBvcnQgdHlwZSBMb2NJbnB1dCA9IHsgYWRkcmVzcz86IHN0cmluZ3xudWxsOyBsYXQ/OiBudW1iZXJ8bnVsbDsgbG9uPzogbnVtYmVyfG51bGwgfTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhZmVFc3RpbWF0ZURpc3RhbmNlKGE6IExvY0lucHV0LCBiOiBMb2NJbnB1dCl7XG4gIC8vIDEpIFByZWZlciBjb29yZGluYXRlcyB3aGVuIGF2YWlsYWJsZVxuICBpZiAoTnVtYmVyLmlzRmluaXRlKGEubGF0IGFzIGFueSkgJiYgTnVtYmVyLmlzRmluaXRlKGEubG9uIGFzIGFueSkgJiYgTnVtYmVyLmlzRmluaXRlKGIubGF0IGFzIGFueSkgJiYgTnVtYmVyLmlzRmluaXRlKGIubG9uIGFzIGFueSkpe1xuICAgIHJldHVybiBvc3JtRGlzdGFuY2UoYS5sYXQgYXMgbnVtYmVyLCBhLmxvbiBhcyBudW1iZXIsIGIubGF0IGFzIG51bWJlciwgYi5sb24gYXMgbnVtYmVyKTtcbiAgfVxuICAvLyAyKSBGYWxsYmFjayB0byB0ZXh0IGFkZHJlc3NlcyAoc2FuaXRpemUpXG4gIGNvbnN0IGF0ID0gKGEuYWRkcmVzc3x8JycpLnRyaW0oKTtcbiAgY29uc3QgYnQgPSAoYi5hZGRyZXNzfHwnJykudHJpbSgpO1xuICBpZiAoYmFkVGV4dChhdCkgfHwgYmFkVGV4dChidCkpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhZGRyZXNzIGlucHV0Jyk7XG4gIGNvbnN0IEEgPSBhd2FpdCBnZW9jb2RlKGF0KTtcbiAgY29uc3QgQiA9IGF3YWl0IGdlb2NvZGUoYnQpO1xuICByZXR1cm4gb3NybURpc3RhbmNlKEEubGF0LCBBLmxvbiwgQi5sYXQsIEIubG9uKTtcbn1cbiJdLCJuYW1lcyI6WyJiYWRUZXh0IiwiYSIsInMiLCJ0cmltIiwibGVuZ3RoIiwidGVzdCIsIm9zcm1EaXN0YW5jZSIsImxhdDEiLCJsb24xIiwibGF0MiIsImxvbjIiLCJ1cmwiLCJyIiwiZmV0Y2giLCJoZWFkZXJzIiwibmV4dCIsInJldmFsaWRhdGUiLCJvayIsIkVycm9yIiwiaiIsImpzb24iLCJyb3V0ZSIsInJvdXRlcyIsImRpc3RhbmNlS20iLCJkaXN0YW5jZSIsImR1cmF0aW9uTWluIiwiTWF0aCIsIm1heCIsInJvdW5kIiwiZHVyYXRpb24iLCJnZW9jb2RlIiwiYWRkciIsInUiLCJVUkwiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJwIiwibGF0IiwiTnVtYmVyIiwibG9uIiwic2FmZUVzdGltYXRlRGlzdGFuY2UiLCJiIiwiaXNGaW5pdGUiLCJhdCIsImFkZHJlc3MiLCJidCIsIkEiLCJCIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/geocode-safe.ts\n");

/***/ }),

/***/ "(rsc)/./lib/price.ts":
/*!**********************!*\
  !*** ./lib/price.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   computeBase: () => (/* binding */ computeBase),\n/* harmony export */   computePrice: () => (/* binding */ computePrice)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n\nfunction isHoliday(at) {\n    const list = (process.env.HOLIDAYS || \"\").split(\",\").map((s)=>s.trim()).filter(Boolean);\n    const ymd = at.toISOString().slice(0, 10);\n    return list.includes(ymd);\n}\nasync function computeBase(distanceKm, durationMin, at) {\n    // اقرأ من Settings إن وُجد، وإلا استخدم القيم الافتراضية\n    const settings = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.prisma.settings.findUnique({\n        where: {\n            id: 1\n        }\n    }).catch(()=>null);\n    const hour = at.getHours();\n    const nightOrHoliday = hour < 6 || hour >= 18 || isHoliday(at);\n    const dayBase = settings?.dayBase ?? 40;\n    const dayKm = settings?.dayPerKm ?? 12.75;\n    const dayMin = settings?.dayPerMin ?? 5.75;\n    const ngBase = settings?.nightBase ?? 60;\n    const ngKm = settings?.nightPerKm ?? 16;\n    const ngMin = settings?.nightPerMin ?? 7;\n    const start = nightOrHoliday ? ngBase : dayBase;\n    const perKm = nightOrHoliday ? ngKm : dayKm;\n    const perMin = nightOrHoliday ? ngMin : dayMin;\n    const price = Math.max(0, start + perKm * distanceKm + perMin * durationMin);\n    return Math.round(price);\n}\nasync function computePrice(distanceKm, durationMin, at, vehicleTypeId) {\n    const base = await computeBase(distanceKm, durationMin, at);\n    if (!vehicleTypeId) return base;\n    const vt = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.prisma.vehicleType.findUnique({\n        where: {\n            id: vehicleTypeId\n        },\n        select: {\n            active: true,\n            multiplier: true\n        }\n    });\n    if (!vt || !vt.active) throw new Error(\"Vehicle type not available\");\n    const mul = Number(vt.multiplier || 1);\n    return Math.round(base * (mul > 0 ? mul : 1));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWtDO0FBRWxDLFNBQVNDLFVBQVVDLEVBQVE7SUFDekIsTUFBTUMsT0FBTyxDQUFDQyxRQUFRQyxHQUFHLENBQUNDLFFBQVEsSUFBRSxFQUFDLEVBQUdDLEtBQUssQ0FBQyxLQUFLQyxHQUFHLENBQUNDLENBQUFBLElBQUlBLEVBQUVDLElBQUksSUFBSUMsTUFBTSxDQUFDQztJQUM1RSxNQUFNQyxNQUFNWCxHQUFHWSxXQUFXLEdBQUdDLEtBQUssQ0FBQyxHQUFFO0lBQ3JDLE9BQU9aLEtBQUthLFFBQVEsQ0FBQ0g7QUFDdkI7QUFFTyxlQUFlSSxZQUFZQyxVQUFpQixFQUFFQyxXQUFrQixFQUFFakIsRUFBUTtJQUMvRSx5REFBeUQ7SUFDekQsTUFBTWtCLFdBQVcsTUFBTXBCLDJDQUFNQSxDQUFDb0IsUUFBUSxDQUFDQyxVQUFVLENBQUM7UUFBRUMsT0FBTztZQUFFQyxJQUFJO1FBQUU7SUFBRSxHQUFHQyxLQUFLLENBQUMsSUFBSTtJQUNsRixNQUFNQyxPQUFPdkIsR0FBR3dCLFFBQVE7SUFDeEIsTUFBTUMsaUJBQWlCLE9BQVEsS0FBS0YsUUFBUSxNQUFPeEIsVUFBVUM7SUFFN0QsTUFBTTBCLFVBQVVSLFVBQVVRLFdBQVc7SUFDckMsTUFBTUMsUUFBVVQsVUFBVVUsWUFBWTtJQUN0QyxNQUFNQyxTQUFVWCxVQUFVWSxhQUFhO0lBQ3ZDLE1BQU1DLFNBQVViLFVBQVVjLGFBQWE7SUFDdkMsTUFBTUMsT0FBVWYsVUFBVWdCLGNBQWM7SUFDeEMsTUFBTUMsUUFBVWpCLFVBQVVrQixlQUFlO0lBRXpDLE1BQU1DLFFBQVNaLGlCQUFpQk0sU0FBU0w7SUFDekMsTUFBTVksUUFBU2IsaUJBQWlCUSxPQUFTTjtJQUN6QyxNQUFNWSxTQUFTZCxpQkFBaUJVLFFBQVNOO0lBRXpDLE1BQU1XLFFBQVFDLEtBQUtDLEdBQUcsQ0FBQyxHQUFHTCxRQUFRQyxRQUFRdEIsYUFBYXVCLFNBQVN0QjtJQUNoRSxPQUFPd0IsS0FBS0UsS0FBSyxDQUFDSDtBQUNwQjtBQUVPLGVBQWVJLGFBQWE1QixVQUFpQixFQUFFQyxXQUFrQixFQUFFakIsRUFBUSxFQUFFNkMsYUFBc0I7SUFDeEcsTUFBTUMsT0FBTyxNQUFNL0IsWUFBWUMsWUFBWUMsYUFBYWpCO0lBQ3hELElBQUksQ0FBQzZDLGVBQWUsT0FBT0M7SUFDM0IsTUFBTUMsS0FBSyxNQUFNakQsMkNBQU1BLENBQUNrRCxXQUFXLENBQUM3QixVQUFVLENBQUM7UUFBRUMsT0FBTztZQUFFQyxJQUFJd0I7UUFBYztRQUFHSSxRQUFRO1lBQUVDLFFBQVE7WUFBTUMsWUFBWTtRQUFLO0lBQUU7SUFDMUgsSUFBSSxDQUFDSixNQUFNLENBQUNBLEdBQUdHLE1BQU0sRUFBRSxNQUFNLElBQUlFLE1BQU07SUFDdkMsTUFBTUMsTUFBTUMsT0FBT1AsR0FBR0ksVUFBVSxJQUFJO0lBQ3BDLE9BQU9WLEtBQUtFLEtBQUssQ0FBQ0csT0FBUU8sQ0FBQUEsTUFBTSxJQUFJQSxNQUFNO0FBQzVDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vOTQ0LXRyYWZpay8uL2xpYi9wcmljZS50cz9mODg0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL2RiJztcblxuZnVuY3Rpb24gaXNIb2xpZGF5KGF0OiBEYXRlKXtcbiAgY29uc3QgbGlzdCA9IChwcm9jZXNzLmVudi5IT0xJREFZU3x8JycpLnNwbGl0KCcsJykubWFwKHM9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xuICBjb25zdCB5bWQgPSBhdC50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApO1xuICByZXR1cm4gbGlzdC5pbmNsdWRlcyh5bWQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tcHV0ZUJhc2UoZGlzdGFuY2VLbTpudW1iZXIsIGR1cmF0aW9uTWluOm51bWJlciwgYXQ6IERhdGUpe1xuICAvLyDYp9mC2LHYoyDZhdmGIFNldHRpbmdzINil2YYg2YjZj9is2K/YjCDZiNil2YTYpyDYp9iz2KrYrtiv2YUg2KfZhNmC2YrZhSDYp9mE2KfZgdiq2LHYp9i22YrYqVxuICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IHByaXNtYS5zZXR0aW5ncy5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IDEgfSB9KS5jYXRjaCgoKT0+bnVsbCk7XG4gIGNvbnN0IGhvdXIgPSBhdC5nZXRIb3VycygpO1xuICBjb25zdCBuaWdodE9ySG9saWRheSA9IChob3VyIDwgNiB8fCBob3VyID49IDE4KSB8fCBpc0hvbGlkYXkoYXQpO1xuXG4gIGNvbnN0IGRheUJhc2UgPSBzZXR0aW5ncz8uZGF5QmFzZSA/PyA0MDtcbiAgY29uc3QgZGF5S20gICA9IHNldHRpbmdzPy5kYXlQZXJLbSA/PyAxMi43NTtcbiAgY29uc3QgZGF5TWluICA9IHNldHRpbmdzPy5kYXlQZXJNaW4gPz8gNS43NTtcbiAgY29uc3QgbmdCYXNlICA9IHNldHRpbmdzPy5uaWdodEJhc2UgPz8gNjA7XG4gIGNvbnN0IG5nS20gICAgPSBzZXR0aW5ncz8ubmlnaHRQZXJLbSA/PyAxNjtcbiAgY29uc3QgbmdNaW4gICA9IHNldHRpbmdzPy5uaWdodFBlck1pbiA/PyA3O1xuXG4gIGNvbnN0IHN0YXJ0ICA9IG5pZ2h0T3JIb2xpZGF5ID8gbmdCYXNlIDogZGF5QmFzZTtcbiAgY29uc3QgcGVyS20gID0gbmlnaHRPckhvbGlkYXkgPyBuZ0ttICAgOiBkYXlLbTtcbiAgY29uc3QgcGVyTWluID0gbmlnaHRPckhvbGlkYXkgPyBuZ01pbiAgOiBkYXlNaW47XG5cbiAgY29uc3QgcHJpY2UgPSBNYXRoLm1heCgwLCBzdGFydCArIHBlckttICogZGlzdGFuY2VLbSArIHBlck1pbiAqIGR1cmF0aW9uTWluKTtcbiAgcmV0dXJuIE1hdGgucm91bmQocHJpY2UpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tcHV0ZVByaWNlKGRpc3RhbmNlS206bnVtYmVyLCBkdXJhdGlvbk1pbjpudW1iZXIsIGF0OiBEYXRlLCB2ZWhpY2xlVHlwZUlkPzogbnVtYmVyKXtcbiAgY29uc3QgYmFzZSA9IGF3YWl0IGNvbXB1dGVCYXNlKGRpc3RhbmNlS20sIGR1cmF0aW9uTWluLCBhdCk7XG4gIGlmICghdmVoaWNsZVR5cGVJZCkgcmV0dXJuIGJhc2U7XG4gIGNvbnN0IHZ0ID0gYXdhaXQgcHJpc21hLnZlaGljbGVUeXBlLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogdmVoaWNsZVR5cGVJZCB9LCBzZWxlY3Q6IHsgYWN0aXZlOiB0cnVlLCBtdWx0aXBsaWVyOiB0cnVlIH0gfSk7XG4gIGlmICghdnQgfHwgIXZ0LmFjdGl2ZSkgdGhyb3cgbmV3IEVycm9yKCdWZWhpY2xlIHR5cGUgbm90IGF2YWlsYWJsZScpO1xuICBjb25zdCBtdWwgPSBOdW1iZXIodnQubXVsdGlwbGllciB8fCAxKTtcbiAgcmV0dXJuIE1hdGgucm91bmQoYmFzZSAqIChtdWwgPiAwID8gbXVsIDogMSkpO1xufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImlzSG9saWRheSIsImF0IiwibGlzdCIsInByb2Nlc3MiLCJlbnYiLCJIT0xJREFZUyIsInNwbGl0IiwibWFwIiwicyIsInRyaW0iLCJmaWx0ZXIiLCJCb29sZWFuIiwieW1kIiwidG9JU09TdHJpbmciLCJzbGljZSIsImluY2x1ZGVzIiwiY29tcHV0ZUJhc2UiLCJkaXN0YW5jZUttIiwiZHVyYXRpb25NaW4iLCJzZXR0aW5ncyIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlkIiwiY2F0Y2giLCJob3VyIiwiZ2V0SG91cnMiLCJuaWdodE9ySG9saWRheSIsImRheUJhc2UiLCJkYXlLbSIsImRheVBlckttIiwiZGF5TWluIiwiZGF5UGVyTWluIiwibmdCYXNlIiwibmlnaHRCYXNlIiwibmdLbSIsIm5pZ2h0UGVyS20iLCJuZ01pbiIsIm5pZ2h0UGVyTWluIiwic3RhcnQiLCJwZXJLbSIsInBlck1pbiIsInByaWNlIiwiTWF0aCIsIm1heCIsInJvdW5kIiwiY29tcHV0ZVByaWNlIiwidmVoaWNsZVR5cGVJZCIsImJhc2UiLCJ2dCIsInZlaGljbGVUeXBlIiwic2VsZWN0IiwiYWN0aXZlIiwibXVsdGlwbGllciIsIkVycm9yIiwibXVsIiwiTnVtYmVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/price.ts\n");

/***/ }),

/***/ "(rsc)/./lib/rate-limit.ts":
/*!***************************!*\
  !*** ./lib/rate-limit.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clientIpKey: () => (/* binding */ clientIpKey),\n/* harmony export */   limitOrThrow: () => (/* binding */ limitOrThrow)\n/* harmony export */ });\n/* harmony import */ var lru_cache__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lru-cache */ \"(rsc)/./node_modules/lru-cache/dist/esm/index.js\");\n\nconst buckets = new lru_cache__WEBPACK_IMPORTED_MODULE_0__.LRUCache({\n    max: 5000\n});\nasync function limitOrThrow(key, opts) {\n    const now = Date.now();\n    const cur = buckets.get(key);\n    if (!cur || now >= cur.resetAt) {\n        buckets.set(key, {\n            count: 1,\n            resetAt: now + opts.durationSec * 1000\n        });\n        return;\n    }\n    if (cur.count >= opts.points) {\n        const retryAfter = Math.max(1, Math.ceil((cur.resetAt - now) / 1000));\n        const err = new Error(\"Too many requests\");\n        err.status = 429;\n        err.retryAfter = retryAfter;\n        throw err;\n    }\n    cur.count += 1;\n    buckets.set(key, cur);\n}\nfunction clientIpKey(req) {\n    const h = (req.headers.get(\"x-forwarded-for\") || req.headers.get(\"cf-connecting-ip\") || \"local\").split(\",\")[0].trim();\n    return h || \"local\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcmF0ZS1saW1pdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBcUM7QUFPckMsTUFBTUMsVUFBVSxJQUFJRCwrQ0FBUUEsQ0FBNkM7SUFBRUUsS0FBSztBQUFLO0FBRTlFLGVBQWVDLGFBQWFDLEdBQVcsRUFBRUMsSUFBVTtJQUN4RCxNQUFNQyxNQUFNQyxLQUFLRCxHQUFHO0lBQ3BCLE1BQU1FLE1BQU1QLFFBQVFRLEdBQUcsQ0FBQ0w7SUFDeEIsSUFBSSxDQUFDSSxPQUFPRixPQUFPRSxJQUFJRSxPQUFPLEVBQUM7UUFDN0JULFFBQVFVLEdBQUcsQ0FBQ1AsS0FBSztZQUFFUSxPQUFPO1lBQUdGLFNBQVNKLE1BQU1ELEtBQUtRLFdBQVcsR0FBRztRQUFLO1FBQ3BFO0lBQ0Y7SUFDQSxJQUFJTCxJQUFJSSxLQUFLLElBQUlQLEtBQUtTLE1BQU0sRUFBQztRQUMzQixNQUFNQyxhQUFhQyxLQUFLZCxHQUFHLENBQUMsR0FBR2MsS0FBS0MsSUFBSSxDQUFDLENBQUNULElBQUlFLE9BQU8sR0FBR0osR0FBRSxJQUFHO1FBQzdELE1BQU1ZLE1BQVcsSUFBSUMsTUFBTTtRQUMzQkQsSUFBSUUsTUFBTSxHQUFHO1FBQUtGLElBQUlILFVBQVUsR0FBR0E7UUFDbkMsTUFBTUc7SUFDUjtJQUNBVixJQUFJSSxLQUFLLElBQUk7SUFBR1gsUUFBUVUsR0FBRyxDQUFDUCxLQUFLSTtBQUNuQztBQUVPLFNBQVNhLFlBQVlDLEdBQVk7SUFDdEMsTUFBTUMsSUFBSSxDQUFDRCxJQUFJRSxPQUFPLENBQUNmLEdBQUcsQ0FBQyxzQkFBc0JhLElBQUlFLE9BQU8sQ0FBQ2YsR0FBRyxDQUFDLHVCQUF1QixPQUFNLEVBQUdnQixLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQ0MsSUFBSTtJQUNuSCxPQUFPSCxLQUFLO0FBQ2QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly85NDQtdHJhZmlrLy4vbGliL3JhdGUtbGltaXQudHM/MjJjOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMUlVDYWNoZSB9IGZyb20gJ2xydS1jYWNoZSc7XG5cbi8vIFZlcnkgc2ltcGxlIGluLW1lbW9yeSByYXRlIGxpbWl0ZXIgKHBlci1wcm9jZXNzKS4gRm9yIHByb2R1Y3Rpb24sIGJhY2sgd2l0aCBSZWRpcy5cbi8vIFVzYWdlOiBhd2FpdCBsaW1pdE9yVGhyb3coa2V5LCB7IHBvaW50czo1LCBkdXJhdGlvblNlYzo2MCB9KVxuXG50eXBlIE9wdHMgPSB7IHBvaW50czogbnVtYmVyOyBkdXJhdGlvblNlYzogbnVtYmVyIH07XG5cbmNvbnN0IGJ1Y2tldHMgPSBuZXcgTFJVQ2FjaGU8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IHJlc2V0QXQ6IG51bWJlciB9Pih7IG1heDogNTAwMCB9KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbWl0T3JUaHJvdyhrZXk6IHN0cmluZywgb3B0czogT3B0cyl7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGN1ciA9IGJ1Y2tldHMuZ2V0KGtleSk7XG4gIGlmICghY3VyIHx8IG5vdyA+PSBjdXIucmVzZXRBdCl7XG4gICAgYnVja2V0cy5zZXQoa2V5LCB7IGNvdW50OiAxLCByZXNldEF0OiBub3cgKyBvcHRzLmR1cmF0aW9uU2VjICogMTAwMCB9KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGN1ci5jb3VudCA+PSBvcHRzLnBvaW50cyl7XG4gICAgY29uc3QgcmV0cnlBZnRlciA9IE1hdGgubWF4KDEsIE1hdGguY2VpbCgoY3VyLnJlc2V0QXQgLSBub3cpLzEwMDApKTtcbiAgICBjb25zdCBlcnI6IGFueSA9IG5ldyBFcnJvcignVG9vIG1hbnkgcmVxdWVzdHMnKTtcbiAgICBlcnIuc3RhdHVzID0gNDI5OyBlcnIucmV0cnlBZnRlciA9IHJldHJ5QWZ0ZXI7XG4gICAgdGhyb3cgZXJyO1xuICB9XG4gIGN1ci5jb3VudCArPSAxOyBidWNrZXRzLnNldChrZXksIGN1cik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGllbnRJcEtleShyZXE6IFJlcXVlc3Qpe1xuICBjb25zdCBoID0gKHJlcS5oZWFkZXJzLmdldCgneC1mb3J3YXJkZWQtZm9yJykgfHwgcmVxLmhlYWRlcnMuZ2V0KCdjZi1jb25uZWN0aW5nLWlwJykgfHwgJ2xvY2FsJykuc3BsaXQoJywnKVswXS50cmltKCk7XG4gIHJldHVybiBoIHx8ICdsb2NhbCc7XG59XG4iXSwibmFtZXMiOlsiTFJVQ2FjaGUiLCJidWNrZXRzIiwibWF4IiwibGltaXRPclRocm93Iiwia2V5Iiwib3B0cyIsIm5vdyIsIkRhdGUiLCJjdXIiLCJnZXQiLCJyZXNldEF0Iiwic2V0IiwiY291bnQiLCJkdXJhdGlvblNlYyIsInBvaW50cyIsInJldHJ5QWZ0ZXIiLCJNYXRoIiwiY2VpbCIsImVyciIsIkVycm9yIiwic3RhdHVzIiwiY2xpZW50SXBLZXkiLCJyZXEiLCJoIiwiaGVhZGVycyIsInNwbGl0IiwidHJpbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/rate-limit.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/semver","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time","vendor-chunks/bcryptjs","vendor-chunks/zod","vendor-chunks/lru-cache"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.ts&appDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmoses%5CProjects%5CWebsites%5C944-TrafikTaxa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();